var d={urls:["https://*/cgi-bin/*"],types:["xmlhttprequest"]};function e(a){if(!window.localStorage.hosts)return!0;var b=window.localStorage.hosts.split("|");a=a.split("/")[2];for(var c=0,f=b.length;c<f;++c)if(b[c]==a)return!1;return!0}chrome.webRequest.onBeforeSendHeaders.addListener(function(a){if(!e(a.url)){a=a.requestHeaders;for(var b=0,c=a.length;b<c;++b)if("User-Agent"==a[b].name){a[b].value="QNXWebClient/1.0";break}return{requestHeaders:a}}},d,["requestHeaders","blocking"]);chrome.webRequest.onHeadersReceived.addListener(function(a){if(!e(a.url)){a=a.responseHeaders;for(var b=0,c=a.length;b<c;++b)if("content-type"==a[b].name.toLowerCase()){"text/xml"!=a[b].value&&(a[b].value="application/octet-stream");break}return{responseHeaders:a}}},d,["responseHeaders","blocking"]);chrome.tabs.onUpdated.addListener(function(a,b,c){"complete"==b.status&&c.url&&"https://"==c.url.slice(0,8)&&!e(c.url)&&chrome.tabs.executeScript(a,{code:'document.head.appendChild(document.createElement("script")).src=chrome.extension.getURL("pb-apps.js");',runAt:"document_start"})});chrome.browserAction.onClicked.addListener(function(){window.open("options.html")});"undefined"==typeof window.localStorage.hosts&&(window.localStorage.hosts="",window.open("options.html"));