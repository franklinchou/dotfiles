!function(){if(!isSafari()||window.top==window){var a={en:{button_text:"save to pocket",success_saved_text:"saved to pocket"},de:{button_text:"in pocket speichern",success_saved_text:"in pocket gespeichert"},es:{button_text:"guardar en pocket",success_saved_text:"guardado en pocket"},es_419:{button_text:"guardar en pocket",success_saved_text:"guardado en pocket"},fr:{button_text:"sauvegarder dans Pocket",success_saved_text:"sauvegardé dans Pocket"},it:{button_text:"salva in pocket",success_saved_text:"salvato in Pocket"},ja:{button_text:"pocket に保存",success_saved_text:"pocket に保存済み"},ru:{button_text:"сохранить в pocket",success_saved_text:"сохранены в pocket"},ko:{button_text:"Pocket에 저장",success_saved_text:"이(가) Pocket에 저장됨"},nl:{button_text:"opslaan naar pocket",success_saved_text:"opgeslagen naar pocket"},pl:{button_text:"zapisz do pocket",success_saved_text:"zapisano w aplikacji pocket"},pt_BR:{button_text:"Salvar no Pocket",success_saved_text:"Salvo no Pocket"},pt_PT:{button_text:"guardar no pocket",success_saved_text:"guardado no Pocket"},zh_CN:{button_text:"保存到 Pocket",success_saved_text:"已保存到 Pocket"},zh_TW:{button_text:"儲存到 Pocket",success_saved_text:"已儲存到 Pocket"}},b={};b.base="http://news.ycombinator.org/",b.buttons=[{text:a[getCurrentLanguageCode()].button_text,successText:a[getCurrentLanguageCode()].success_saved_text,container:"td.subtext",className:"pocket-hn-button",selector:".pocket-hn-button",data:function(a){var c=$(a).parents("tr").prev("tr").find(".title").children("a"),d=$(c).text().trim(),f=$(c).attr("href").trim(),g=e(f,b.base);return{title:d,url:g}}}];var c=function(a){var b=document.createElement("a");return b.setAttribute("class",a.className),b.setAttribute("href","#"),$(b).text(a.text),b},d=function(){var a,d=b.buttons.length;for(a=0;d>a;a++){var e=b.buttons[a];$(e.container).each(function(){var a=$(this);if(!$(a).hasClass("pocket-inserted")){$(a).addClass("pocket-inserted");var b=c(e);$(a).append(b),$(b).before(" | ");var d=e.data;$(b).on("click",function(a){var c=d(b),f={identifier:"hackernews",action:"addURL",url:c.url,title:c.title,actionInfo:{cxt_ui:"btn_hackernews",cxt_url:window.location.href}};sendMessage(f,function(a){"success"===a.status&&($(b).replaceWith($("<span>"+e.successText+"</span>")),document.body.style.cursor="default")}),a.preventDefault()})}})}},e=function(a,b){if(/^https?:/.test(a))return a;var c,d=document,e=d.getElementsByTagName("base")[0],f=e&&e.href,g=d.head||d.getElementsByTagName("head")[0],h=e||g.appendChild(d.createElement("base")),i=d.createElement("a");return h.href=b,i.href=a,c=i.href,e?e.href=f:g.removeChild(h),c};addMessageListener(function(a,b,c){"settingChanged"===a.action&&"hackernews"===a.key&&("true"===a.value||a.value===!0)&&d()}),sendMessage({action:"getSetting",key:"hackernews"},function(a){("true"===a.value||a.value===!0)&&d()})}}();